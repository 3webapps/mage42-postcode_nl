var PostcodeNl=PostcodeNl||{};(function(){"use strict";const e=window.document,t=new WeakMap,n=Object.create(null,{context:{value:"nld",writable:!0},autocompleteUrl:{writable:!0},addressDetailsUrl:{writable:!0},tags:{value:{"unvalidated-housenumber":"(unknown house number)","unvalidated-housenumber-addition":"(unknown house number addition)"},writable:!0},cssPrefix:{value:"postcodenl-autocomplete-",writable:!0},minLength:{value:1,writable:!0},delay:{value:300,writable:!0},appendTo:{value:e.body,writable:!0},autoFocus:{value:!1,writable:!0},autoSelect:{value:!1,writable:!0},getResponseMessage:{value:function(e){let t;return t=e>1?e+" address suggestions available. ":"One address suggestion available. ",t+="Use up and down arrow keys to navigate."},writable:!0}}),s=function(n){const s=this,o=e.createElement("ul"),i=e.createElement("div"),l={menuOpen:n.cssPrefix+"menu-open",itemFocus:n.cssPrefix+"item-focus"},a=function(e,n){if(0===o.children.length)return;const s=e?o.firstElementChild:o.lastElementChild,i=e?o.lastElementChild:o.firstElementChild;if(void 0===n&&(n=!0),c(),null===h)h=s;else{if(h===i)return h=null,r.value=u,void(t.get(r).context=d);h=(e?h.nextElementSibling:h.previousElementSibling)||s}if(h.classList.add(l.itemFocus),o.scrollTop>h.offsetTop?o.scrollTop=h.offsetTop:h.offsetHeight+h.offsetTop>o.clientHeight&&(o.scrollTop=h.offsetHeight+h.offsetTop-o.clientHeight),n&&!0===r.dispatchEvent(new CustomEvent("autocomplete-focus",{cancelable:!0}))){const e=t.get(h);r.value=e.value,t.get(r).context=e.context}},c=function(){null!==h&&h.classList.remove(l.itemFocus)};let r,u,d,p=!1,f=!1,h=null;Object.defineProperties(this,{isOpen:{get:function(){return p}},isMousedown:{get:function(){return f}},hasFocus:{get:function(){return null!==h}}}),i.classList.add(n.cssPrefix+"menu"),o.classList.add(n.cssPrefix+"menu-items"),i.appendChild(o),o.addEventListener("mouseover",function(e){if(e.target===o)return;c();let t=e.target;for(;t.parentElement!==o;)t=t.parentElement;(h=t).classList.add(l.itemFocus)}),o.addEventListener("mouseout",function(){c(),h=null}),i.addEventListener("mousedown",function(){f=!0}),i.addEventListener("click",function(e){e.preventDefault(),null!==h&&s.select(),f=!1}),HTMLElement.prototype.isPrototypeOf(n.appendTo)?n.appendTo.appendChild(i):(e.querySelector(n.appendTo)||e.body).appendChild(i),this.setItems=function(e,n){o.innerHTML="",o.scrollTop=0;for(let s,i,l=0;i=e[l++];)s=n(o,i),t.set(s,i);h=null},this.open=function(e){u=(r=e).value,d=t.get(r).context,n.autoFocus&&null===h&&this.focusNext(!1),p||(!function(e){const t=e.getBoundingClientRect();i.style.top=t.bottom+(window.scrollY||window.pageYOffset)+"px",i.style.left=t.left+(window.scrollX||window.pageXOffset)+"px",i.style.width=t.width+"px"}(r),i.classList.add(l.menuOpen),o.scrollTop=0,p=!0,r.dispatchEvent(new CustomEvent("autocomplete-open")))},this.close=function(e){p&&(e&&(r.value=u,t.get(r).context=d),c(),h=null,i.classList.remove(l.menuOpen),p=!1,r.dispatchEvent(new CustomEvent("autocomplete-close")))},this.focusPrevious=a.bind(this,!1),this.focusNext=a.bind(this,!0),this.select=function(){const e=t.get(h);!0===r.dispatchEvent(new CustomEvent("autocomplete-select",{detail:e,cancelable:!0}))&&(r.value=e.value),r.focus()},this.clear=function(){c(),h=null,o.innerHTML=""},e.addEventListener("click",function(e){p&&e.target!==r&&!i.contains(e.target)&&s.close()}),window.addEventListener("resize",function(){p&&s.close()})};this.AutocompleteAddress=function(a,c){let r;if("string"==typeof a)u=a,r=e.querySelectorAll(u);else if(HTMLElement.prototype.isPrototypeOf(a))r=[a];else{if(!NodeList.prototype.isPrototypeOf(a))throw new TypeError("Element(s) or selector has invalid type. Use HTMLElement, NodeList or valid CSS selector string.");r=a}var u;if(0===r.length)return;c=l(Object.create(n),c),Object.defineProperty(this,"options",{get:function(){return c}});let d=null,p=null,f=null,h=[];const m=this,v=new s(c),g=c.cssPrefix+"address-input-blank",w=e.createElement("div");w.id=i("aria-live-region"),w.setAttribute("aria-role","status"),w.setAttribute("aria-live","assertive"),w.classList.add(c.cssPrefix+w.id),e.body.appendChild(w),this.announce=function(e){w.innerHTML="<div>"+e+"</div>"},this.xhrGet=function(e,t){const n=new XMLHttpRequest;return n.addEventListener("load",function(){200===this.status&&t.call(this,JSON.parse(n.response))}),n.open("GET",e),n.setRequestHeader("X-Autocomplete-Session",o()),n.send(),n},this.getSuggestions=function(e,t,n){return this.xhrGet(this.options.autocompleteUrl+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t),n)},this.getDetails=function(e){let t=null,n=arguments[1];const s=[e];return 3===arguments.length&&(t=arguments[1],n=arguments[2],s.push(t)),this.xhrGet(this.options.addressDetailsUrl+"/"+s.join("/"),n)},this.renderItem=function(t,n){const s=e.createElement("li"),o=e.createElement("span");if(s.classList.add(this.options.cssPrefix+"item"),o.classList.add(this.options.cssPrefix+"item-label"),o.innerHTML=this.highlight(n.label,n.highlights),s.appendChild(o),"Address"!==n.precision&&s.classList.add(this.options.cssPrefix+"item-more"),n.description){let t=e.createElement("span");t.textContent=n.description,t.classList.add(this.options.cssPrefix+"item-description"),s.appendChild(t)}if(n.tags)for(let t,o=0;t=n.tags[o++];){let n=e.createElement("em");n.textContent=this.options.tags[t],n.classList.add(this.options.cssPrefix+"item-tag"),s.appendChild(n)}return t.appendChild(s),s},this.highlight=function(e,t){if(0===t.length)return e;for(var n,s=0,o=0,i=0,l=[];n=t[s++];)l.push(e.slice(i,n[0])),o=n[0],i=n[1],l.push("<mark>"+e.slice(o,i)+"</mark>");return l.push(e.slice(i)),l.join("")},this.setCountry=function(e){c.context=e.toLowerCase();for(let e,n=0;e=r[n++];)t.get(e).context=c.context},this.search=function(e,t){void 0!==t&&(e.value=t),e.classList.toggle(g,""===e.value),b(e)},Array.prototype.forEach.call(r,function(e){let n=!1;t.set(e,{match:{},context:c.context}),e.spellcheck=!1,e.autocomplete="off",e.setAttribute("aria-controls",w.id),e.classList.add(c.cssPrefix+"address-input"),e.classList.toggle(g,""===e.value),e.addEventListener("keydown",function(t){switch(n=!0,t.key){case"ArrowUp":v.isOpen?v.focusPrevious():b(e),t.preventDefault();break;case"ArrowDown":v.isOpen?v.focusNext():b(e),t.preventDefault();break;case"Escape":v.close(!0);break;case"Tab":case"Enter":v.hasFocus&&(v.select(),t.preventDefault());break;default:E(e)}}),e.addEventListener("input",function(t){e.classList.remove(g),n?n=!1:E(e)}),e.addEventListener("focus",function(){if(v.isMousedown)return;v.open(e);const n=t.get(e);void 0!==n.match.precision&&"Address"===n.match.precision||b(e)}),e.addEventListener("click",v.open.bind(v,e)),e.addEventListener("autocomplete-select",function(n){const s=t.get(e);s.match=n.detail,"Address"===n.detail.precision?v.close():(v.open(e),s.context=n.detail.context,window.setTimeout(b,0,e))}),e.addEventListener("blur",function(){if(v.isMousedown)return;const n=t.get(e);if(window.clearTimeout(d),v.close(),c.autoSelect&&void 0===n.match.context)for(let t,n=0;t=h[n++];)if("Address"===t.precision){e.value=t.value,e.dispatchEvent(new CustomEvent("autocomplete-select",{detail:t}));break}e.classList.toggle(g,""===e.value)})});const E=function(e){window.clearTimeout(d),d=window.setTimeout(b,c.delay,e)},b=function(e){if(v.open(e),e.value.length<c.minLength)return void v.clear();const n=t.get(e);if(e.value===p&&n.context===f)return;const s=n.context===f&&null!==p&&(0===e.value.indexOf(p)||0===p.indexOf(e.value));if(p=e.value,f=n.context,n.match={},!1===e.dispatchEvent(new CustomEvent("autocomplete-search",{cancelable:!0})))return;e.classList.add(c.cssPrefix+"loading");const o=m.getSuggestions.call(m,n.context,e.value,function(t){if(!0===e.dispatchEvent(new CustomEvent("autocomplete-response",{detail:t,cancelable:!0}))){if(h=t.matches,s&&0===h.length)return;v.setItems(h,m.renderItem.bind(m)),m.announce(c.getResponseMessage(h.length)),c.autoFocus&&v.focusNext(!1)}});o.addEventListener("error",function(t){e.dispatchEvent(new CustomEvent("autocomplete-error",{detail:t}))}),o.addEventListener("loadend",function(t){e.classList.remove(c.cssPrefix+"loading")})}},Object.defineProperty(this.AutocompleteAddress,"defaults",{get:function(){return n}});const o=function(){const e=new Uint8Array(32),t=[];(window.crypto||window.msCrypto).getRandomValues(e);for(let n=0,s="0123456789abcdef".length;n<32;n++)t.push("0123456789abcdef"[e[n]%s]);const n=t.join("");return function(){return n}}(),i=function(t){let n=2,s=t;for(;null!==e.getElementById(s);)s=t+"-"+n,n++;return s},l=function(e,t){for(let n in t)e[n]=t[n];return e};if("function"!=typeof window.CustomEvent){const t=function(t,n){n=n||{bubbles:!1,cancelable:!1,detail:null};var s=e.createEvent("CustomEvent");return s.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),s};window.CustomEvent=t}}).apply(PostcodeNl);